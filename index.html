<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>There is / There are - Game</title>
    <style>
        :root {
            --primary: #4a90e2;
            --secondary: #f5a623;
            --bg: #f0f4f8;
            --true-color: #28a745;
            --false-color: #dc3545;
        }

        body {
            font-family: 'Comic Sans MS', 'Comic Sans', cursive, sans-serif;
            background-color: var(--bg);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        h1 { color: #333; margin-bottom: 20px; text-align: center; }

        /* Navigation */
        .nav {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .nav-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            background-color: #e0e0e0;
            cursor: pointer;
            font-size: 1.1rem;
            transition: all 0.2s;
            font-family: inherit;
            color: #555;
            font-weight: bold;
        }

        .nav-btn.active {
            background-color: var(--primary);
            color: white;
            box-shadow: 0 4px 10px rgba(74, 144, 226, 0.4);
            transform: translateY(-2px);
        }

        /* Game Area */
        .game-container {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            text-align: center;
            max-width: 800px;
            width: 100%;
        }

        /* Cards Styling */
        .cards-row {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .card {
            width: 160px;
            height: 160px;
            border: 3px solid #eee;
            border-radius: 20px;
            background: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
            padding: 10px;
            box-sizing: border-box;
            position: relative;
        }

        .card img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            display: block;
        }

        /* Fallback styling */
        .card-fallback {
            font-size: 1.5rem;
            font-weight: bold;
            color: #777;
            text-align: center;
        }

        /* Controls */
        .action-btn {
            background-color: var(--secondary);
            color: white;
            border: none;
            padding: 15px 50px;
            font-size: 1.5rem;
            border-radius: 50px;
            cursor: pointer;
            font-family: inherit;
            box-shadow: 0 5px 0 #d38d1b;
            transition: transform 0.1s;
            margin-top: 20px;
        }

        .action-btn:active {
            transform: translateY(5px);
            box-shadow: none;
        }

        /* Text Styles */
        .mode-title {
            color: #666;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        /* Unscramble Styles */
        .sentence-placeholder {
            min-height: 60px;
            border-bottom: 2px dashed #ccc;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 8px;
            margin-bottom: 20px;
            padding: 10px;
        }

        .word-tag {
            background: #e1efff;
            border: 2px solid #4a90e2;
            color: #4a90e2;
            padding: 8px 15px;
            border-radius: 10px;
            font-size: 1.3rem;
            cursor: default;
        }

        .word-pool {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            min-height: 50px;
        }

        .clickable-word {
            background: white;
            border: 2px solid #ddd;
            color: #333;
            padding: 8px 15px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.3rem;
            transition: all 0.2s;
            user-select: none;
        }
        .clickable-word:hover {
            border-color: var(--secondary);
            transform: translateY(-2px);
        }
        .clickable-word.used {
            opacity: 0.2;
            cursor: default;
            transform: none;
            border-color: #ddd;
        }

        /* True/False Styles */
        .tf-container {
            margin-top: 20px;
        }
        .tf-sentence {
            font-size: 1.8rem;
            margin-bottom: 20px;
            color: #333;
        }
        .tf-btn {
            padding: 15px 40px;
            font-size: 1.5rem;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            color: white;
            font-family: inherit;
            margin: 0 15px;
            transition: transform 0.1s;
            opacity: 0.9;
            min-width: 120px;
        }
        .tf-btn:hover { opacity: 1; transform: scale(1.05); }
        .btn-true { background-color: var(--true-color); box-shadow: 0 4px 0 #1e7e34; }
        .btn-false { background-color: var(--false-color); box-shadow: 0 4px 0 #bd2130; }
        .tf-btn:active { transform: translateY(4px); box-shadow: none; }

        .result-msg {
            font-size: 1.6rem;
            font-weight: bold;
            height: 40px;
            margin-top: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .hidden { display: none; }
    </style>
</head>
<body>

    <h1>Grammar Game</h1>

    <div class="nav">
        <button class="nav-btn active" onclick="setMode('unscramble')">1. Make Sentence</button>
        <button class="nav-btn" onclick="setMode('practice')">2. Say Sentence</button>
        <button class="nav-btn" onclick="setMode('correction')">3. True or False</button>
    </div>

    <div class="game-container">
        <!-- Images Display: STRICT ORDER (Number - Color - Object) -->
        <div class="cards-row">
            <div class="card" id="card-num"></div>
            <div class="card" id="card-color"></div>
            <div class="card" id="card-obj"></div>
        </div>

        <!-- MODE 1: Unscramble -->
        <div id="mode-unscramble" class="mode-content">
            <div class="mode-title">Click words in the correct order:</div>
            <div class="sentence-placeholder" id="build-area"></div>
            <div class="word-pool" id="words-pool"></div>
            <div class="result-msg" id="unscramble-result"></div>
            <button class="action-btn" onclick="nextRound()">Next</button>
            <div style="margin-top:10px;">
                <small style="color:#999; cursor:pointer;" onclick="resetUnscramble()">Reset Words</small>
            </div>
        </div>

        <!-- MODE 2: Practice -->
        <div id="mode-practice" class="mode-content hidden">
            <div class="mode-title">Look at the pictures and say the sentence!</div>
            <div style="height: 60px;"></div>
            <button class="action-btn" onclick="nextRound()">Next</button>
        </div>

        <!-- MODE 3: Correction -->
        <div id="mode-correction" class="mode-content hidden">
            <div class="mode-title">Is this sentence correct?</div>
            <div class="tf-sentence" id="tf-text">...</div>
            <div class="tf-container">
                <button class="tf-btn btn-true" onclick="checkTF(true)">Yes</button>
                <button class="tf-btn btn-false" onclick="checkTF(false)">No</button>
            </div>
            <div class="result-msg" id="tf-result"></div>
            <button class="action-btn" onclick="nextRound()">Next</button>
        </div>
    </div>

    <script>
        // --- DATA ---
        // Cleaned list: No colors in the 'objects' array
        const data = {
            numbers: Array.from({length: 20}, (_, i) => i + 1),
            colors: [
                {name: "beige", hex: "#f5f5dc"}, {name: "black", hex: "#000000"},
                {name: "blue", hex: "#007bff"}, {name: "brown", hex: "#8b4513"},
                {name: "green", hex: "#28a745"}, {name: "grey", hex: "#808080"},
                {name: "orange", hex: "#fd7e14"}, {name: "pink", hex: "#e83e8c"},
                {name: "purple", hex: "#6f42c1"}, {name: "red", hex: "#dc3545"},
                {name: "white", hex: "#ffffff"}, {name: "yellow", hex: "#ffc107"}
            ],
            objects: [
                {name: "alien"}, {name: "armchair"}, 
                {name: "bath"}, {name: "bed"}, 
                {name: "board"}, {name: "bookcase"}, 
                // "brown" REMOVED from objects
                {name: "camera"}, {name: "clock"}, 
                {name: "cupboard"}, {name: "desk"}, 
                {name: "kite"}, {name: "lamp"}, 
                {name: "lorry"}, {name: "mat"}, 
                {name: "mirror"}, {name: "phone"}, 
                {name: "robot"}, {name: "ruler"}, 
                {name: "sofa"}, {name: "tablet"}, 
                {name: "teddy"}, {name: "watch"}
            ]
        };

        const numWords = {
            1: "one", 2: "two", 3: "three", 4: "four", 5: "five",
            6: "six", 7: "seven", 8: "eight", 9: "nine", 10: "ten",
            11: "eleven", 12: "twelve", 13: "thirteen", 14: "fourteen", 15: "fifteen",
            16: "sixteen", 17: "seventeen", 18: "eighteen", 19: "nineteen", 20: "twenty"
        };

        let currentMode = 'unscramble';
        let currentData = {};
        let isTFTrue = false;
        let builtSentence = [];

        window.onload = () => {
            nextRound();
        };

        function setMode(mode) {
            currentMode = mode;
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            document.querySelectorAll('.mode-content').forEach(div => div.classList.add('hidden'));
            document.getElementById(`mode-${mode}`).classList.remove('hidden');

            refreshCurrentModeLogic(); 
        }

        function getPlural(word) {
            if (word === 'lorry') return 'lorries';
            if (word === 'teddy') return 'teddies';
            if (word === 'watch') return 'watches';
            if (word === 'box') return 'boxes';
            if (word === 'bath') return 'baths';
            return word + 's';
        }

        function generateData() {
            // Logic to ensure 33% chance of "1"
            let rNum;
            if (Math.random() < 0.33) {
                rNum = 1;
            } else {
                rNum = Math.floor(Math.random() * 19) + 2;
            }
            
            // Strictly pick a color for the 2nd slot and object for the 3rd
            const rColor = data.colors[Math.floor(Math.random() * data.colors.length)];
            const rObj = data.objects[Math.floor(Math.random() * data.objects.length)];
            
            return { num: rNum, color: rColor, obj: rObj };
        }

        function getCorrectSentence(d) {
            let noun = d.num === 1 ? d.obj.name : getPlural(d.obj.name);
            let verb = d.num === 1 ? "is" : "are";
            let numberWord = numWords[d.num];
            return `There ${verb} ${numberWord} ${d.color.name} ${noun}.`;
        }

        function renderCards(d) {
            // STRICT ORDER RENDERING
            renderOneCard('card-num', 'num', d.num);     // 1. Number
            renderOneCard('card-color', 'color', d.color); // 2. Color
            renderOneCard('card-obj', 'obj', d.obj);     // 3. Object
        }

        function renderOneCard(elementId, type, item) {
            const el = document.getElementById(elementId);
            el.innerHTML = '';
            el.style.borderColor = "#eee";

            const img = document.createElement('img');
            
            let filename = '';
            // Filename generation based on type
            if (type === 'num') filename = `${item}.png`;
            if (type === 'color') filename = `${item.name}.png`;
            if (type === 'obj') filename = `${item.name}.png`;

            img.src = `img/${filename}`;
            
            img.onerror = () => {
                img.style.display = 'none';
                // Fallback text
                if (type === 'num') {
                    el.innerHTML = `<div class="card-fallback">${item}</div>`;
                } else if (type === 'color') {
                    el.innerHTML = `<div class="card-fallback" style="color:${item.hex}; font-size:1.2rem;">${item.name.toUpperCase()}</div>`;
                    el.style.borderColor = item.hex;
                } else {
                    el.innerHTML = `<div class="card-fallback" style="font-size:1.2rem;">${item.name}</div>`;
                }
            };
            el.appendChild(img);
        }

        function nextRound() {
            currentData = generateData();
            renderCards(currentData);
            refreshCurrentModeLogic();
        }

        function refreshCurrentModeLogic() {
            document.getElementById('tf-result').innerHTML = '';
            document.getElementById('unscramble-result').innerHTML = '';

            if (currentMode === 'unscramble') setupUnscramble();
            if (currentMode === 'correction') setupCorrection();
        }

        // --- UNSCRAMBLE LOGIC ---
        function setupUnscramble() {
            builtSentence = [];
            document.getElementById('build-area').innerHTML = '';
            
            const fullSent = getCorrectSentence(currentData);
            const words = fullSent.slice(0, -1).split(' ');
            words.push('.'); 
            
            const shuffled = [...words].sort(() => Math.random() - 0.5);

            const pool = document.getElementById('words-pool');
            pool.innerHTML = '';

            shuffled.forEach(word => {
                const btn = document.createElement('div');
                btn.className = 'clickable-word';
                btn.innerText = word;
                btn.onclick = function() {
                    if(!this.classList.contains('used')) {
                        addWord(word, this);
                    }
                };
                pool.appendChild(btn);
            });
        }

        function addWord(word, el) {
            el.classList.add('used');
            builtSentence.push(word);
            
            const tag = document.createElement('div');
            tag.className = 'word-tag';
            tag.innerText = word;
            document.getElementById('build-area').appendChild(tag);

            checkUnscramble();
        }

        function resetUnscramble() {
            document.getElementById('unscramble-result').innerHTML = '';
            setupUnscramble();
        }

        function checkUnscramble() {
            const correctSent = getCorrectSentence(currentData);
            const targetWords = correctSent.slice(0, -1).split(' ');
            targetWords.push('.'); 

            if (builtSentence.length === targetWords.length) {
                const userString = builtSentence.join(' ');
                const targetString = targetWords.join(' ');
                const res = document.getElementById('unscramble-result');
                
                if (userString === targetString) {
                    res.innerHTML = "<span style='color:green'>Correct!</span>";
                } else {
                    res.innerHTML = "<span style='color:red'>Try again.</span>";
                }
            }
        }

        // --- YES / NO LOGIC ---
        function setupCorrection() {
            const txt = document.getElementById('tf-text');
            isTFTrue = Math.random() > 0.5;

            if (isTFTrue) {
                txt.innerText = getCorrectSentence(currentData);
            } else {
                let wrongData = { ...currentData };
                if (Math.random() > 0.5) {
                    // Mistake in Number
                    wrongData.num = (wrongData.num === 1) ? 3 : 1; 
                } else {
                    // Mistake in Object
                    // Ensure we pick a new OBJECT, not a color
                    let newObj = data.objects[Math.floor(Math.random() * data.objects.length)];
                    while(newObj.name === currentData.obj.name) {
                        newObj = data.objects[Math.floor(Math.random() * data.objects.length)];
                    }
                    wrongData.obj = newObj;
                }
                txt.innerText = getCorrectSentence(wrongData);
            }
        }

        function checkTF(userSaysTrue) {
            const res = document.getElementById('tf-result');
            if (userSaysTrue === isTFTrue) {
                res.innerHTML = "<span style='color:green'>Correct!</span>";
            } else {
                res.innerHTML = "<span style='color:red'>Wrong.</span>";
            }
        }

    </script>
</body>
</html>